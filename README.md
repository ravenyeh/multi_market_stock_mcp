# 台灣股票即時分析 MCP 服務器
## Taiwan Stock Real-Time Analysis MCP Server

一個功能強大的 MCP (Model Context Protocol) 服務器，專為台灣股票市場設計，提供即時報價、技術分析和智能買賣建議。

![Taiwan Stock](https://img.shields.io/badge/Market-Taiwan%20Stock-blue)
![MCP](https://img.shields.io/badge/Protocol-MCP-green)
![Python](https://img.shields.io/badge/Python-3.10%2B-blue)

## 🌟 核心功能

### 1. 即時報價查詢
- 📊 單支股票即時報價
- 📈 多支股票批量查詢
- 💹 買賣五檔完整資訊
- ⏰ 即時更新（約每5秒）

### 2. 技術分析
- 📉 趨勢判斷（上漲/下跌/盤整）
- 📍 價格位置分析（高檔/中檔/低檔）
- 🎯 多層次分析（基本/進階/完整）

### 3. 智能建議
- 💡 買進/賣出/觀望建議
- 🎲 風險等級評估
- 📋 詳細理由說明
- ⚖️ 買賣價差分析

### 4. 比較分析
- 🔍 多股同時比較
- 📊 關鍵指標對比
- 🏆 相對強弱分析

## 🚀 快速開始

### 安裝依賴

```bash
pip install mcp httpx pydantic
```

### 運行服務器

```bash
python taiwan_stock_mcp.py
```

### 配置 Claude Desktop

在 Claude Desktop 的配置文件中添加：

**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
**Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

```json
{
  "mcpServers": {
    "taiwan-stock": {
      "command": "python",
      "args": ["/path/to/taiwan_stock_mcp.py"]
    }
  }
}
```

## 🛠️ 可用工具

### 1. `get_stock_realtime_quote`
取得單支股票的即時報價資訊。

**輸入參數:**
- `stock_code` (必填): 股票代碼，例如 "2330"
- `response_format` (可選): "markdown" 或 "json"，預設為 "markdown"

**使用範例:**
```
請查詢台積電(2330)的即時報價
```

**回應內容:**
- 成交價格與漲跌幅
- 開盤/最高/最低/昨收
- 成交量
- 買賣五檔價量
- 更新時間

---

### 2. `get_multiple_stocks_quotes`
同時查詢多支股票的即時報價。

**輸入參數:**
- `stock_codes` (必填): 股票代碼列表，最多20支
- `response_format` (可選): 輸出格式

**使用範例:**
```
請查詢以下股票的即時報價：2330, 2317, 2454
```

**適用場景:**
- 投資組合監控
- 類股比較
- 同產業分析

---

### 3. `analyze_stock_with_suggestion`
進行技術分析並提供買賣建議。

**輸入參數:**
- `stock_code` (必填): 股票代碼
- `analysis_type` (可選): "basic" / "advanced" / "full"，預設 "basic"
- `response_format` (可選): 輸出格式

**使用範例:**
```
請分析台積電(2330)並給我買賣建議
```

**分析內容:**
- 即時報價資訊
- 趨勢判斷（上漲/下跌/平盤）
- 價格位置（高檔/中檔/低檔區）
- 建議動作（買進/賣出/觀望）
- 詳細理由與風險評估

---

### 4. `compare_stocks`
比較多支股票的表現和技術面。

**輸入參數:**
- `stock_codes` (必填): 要比較的股票代碼列表
- `response_format` (可選): 輸出格式

**使用範例:**
```
請比較台積電、聯電、力積電的表現
```

**比較項目:**
- 當前價格
- 漲跌幅
- 趨勢方向
- 價格位置
- 交易建議
- 風險等級

## 📊 使用案例

### 案例 1: 快速查詢台積電報價

**對話:**
```
User: 請查詢台積電(2330)的即時報價

Claude: 讓我幫你查詢台積電的即時報價...
[調用 get_stock_realtime_quote 工具]

結果顯示：
📊 台積電 (2330)
- 成交價: 508.00 (+2.00, +0.39%)
- 開盤: 515.00
- 最高: 515.00
- 最低: 508.00
- 成交量: 38,118 張
...
```

### 案例 2: 投資決策分析

**對話:**
```
User: 我想買台積電(2330)，請給我專業的分析和建議

Claude: 讓我為你進行完整的技術分析...
[調用 analyze_stock_with_suggestion 工具]

分析結果：
📈 技術分析
- 趨勢: 上漲 (強勢)
- 價格位置: 低檔區 (32.5%)

💡 交易建議
- 建議動作: 買進
- 理由: 股價處於低檔區且呈上漲趨勢，具備向上動能
- 風險等級: 中等
- 買賣價差: 1.00

⚠️ 免責聲明: 以上分析僅供參考，不構成投資建議...
```

### 案例 3: 類股比較

**對話:**
```
User: 請比較半導體三雄（台積電2330、聯電2303、力積電6770）的表現

Claude: 讓我為你比較這三支半導體股票...
[調用 compare_stocks 工具]

比較結果：
| 代碼 | 名稱 | 現價 | 漲跌幅 | 趨勢 | 價格位置 | 建議 | 風險 |
|------|------|------|--------|------|----------|------|------|
| 2330 | 台積電 | 508.00 | +0.39% | 上漲 | 32.5% | 買進 | 中等 |
| 2303 | 聯電 | 45.50 | -1.08% | 下跌 | 58.3% | 觀望 | 中高 |
| 6770 | 力積電 | 35.20 | +2.33% | 上漲 | 75.2% | 觀望 | 高 |
```

### 案例 4: 投資組合監控

**對話:**
```
User: 請幫我監控我的投資組合：2330, 2317, 2454, 0050, 0056

Claude: 讓我查詢你的投資組合即時狀況...
[調用 get_multiple_stocks_quotes 工具]

投資組合報價：
1. 台積電(2330): 508.00 (+0.39%)
2. 鴻海(2317): 102.50 (-0.49%)
3. 聯發科(2454): 890.00 (+1.25%)
4. 元大台灣50(0050): 138.50 (+0.36%)
5. 元大高股息(0056): 35.60 (+0.28%)

整體投資組合今日表現為正...
```

## 🎯 智能建議邏輯

本 MCP 服務器採用多維度分析來生成交易建議：

### 分析維度

1. **趨勢分析**
   - 比較當前價格與昨收價
   - 判斷是上漲、下跌或平盤
   - 評估趨勢強度

2. **價格位置**
   - 計算當前價格在今日價格區間的位置
   - 高檔區 (80%+): 接近最高價
   - 中高檔區 (60-80%): 略高位置
   - 中檔區 (40-60%): 中間位置
   - 中低檔區 (20-40%): 略低位置
   - 低檔區 (<20%): 接近最低價

3. **買賣力道**
   - 分析買賣五檔的價量分布
   - 計算買賣價差
   - 評估市場流動性

### 決策矩陣

| 趨勢 | 價格位置 | 建議動作 | 風險等級 |
|------|----------|----------|----------|
| 上漲 | 低檔 (<40%) | 買進 | 中等 |
| 上漲 | 中檔 (40-70%) | 觀望/小量買進 | 中高 |
| 上漲 | 高檔 (>70%) | 觀望 | 高 |
| 下跌 | 高檔 (>60%) | 賣出/減碼 | 中高 |
| 下跌 | 中檔 (30-60%) | 觀望 | 中等 |
| 下跌 | 低檔 (<30%) | 觀望/小量買進 | 中等 |
| 平盤 | 低檔 (<30%) | 可考慮買進 | 中低 |
| 平盤 | 中檔 (30-70%) | 觀望 | 中等 |
| 平盤 | 高檔 (>70%) | 觀望 | 中等 |

## 📡 資料來源

- **台灣證券交易所** (TWSE): 上市股票資料
- **櫃買中心** (TPEx): 上櫃股票資料
- **更新頻率**: 約每5秒更新一次
- **API 限制**: 每5秒最多3個請求

## ⚠️ 重要聲明

### 免責條款

1. **非投資建議**: 本工具提供的所有分析和建議僅供參考，不構成任何投資建議或建議。

2. **自行評估**: 投資前請務必進行完整的基本面和技術面評估，並考慮個人的風險承受能力。

3. **市場風險**: 股票投資具有市場風險，過去的表現不代表未來的結果，投資人應審慎評估。

4. **資料延遲**: 雖然資料來源為官方交易所，但仍可能存在延遲，請以券商報價為準。

5. **系統限制**: 技術分析基於有限的即時數據，無法完全反映市場所有資訊。

### 使用限制

- 請勿過度頻繁查詢，遵守交易所 API 使用規範
- 僅供個人使用，不得用於商業用途
- 不保證資料的完整性和準確性

## 🔧 技術架構

### 核心技術

- **MCP SDK**: FastMCP 框架
- **HTTP 客戶端**: httpx (異步請求)
- **資料驗證**: Pydantic v2
- **輸出格式**: Markdown / JSON

### 設計特點

1. **異步處理**: 所有 API 請求使用 async/await
2. **錯誤處理**: 完整的異常捕獲和友善錯誤訊息
3. **資料驗證**: Pydantic 模型自動驗證輸入
4. **格式彈性**: 支援 Markdown 和 JSON 兩種輸出
5. **速率控制**: 自動控制請求頻率避免被封鎖

## 🤝 貢獻

歡迎提交 Issue 和 Pull Request！

## 📄 授權

MIT License

## 📮 聯繫方式

有任何問題或建議，歡迎聯繫！

---

**⭐ 如果這個專案對你有幫助，請給個星星！**

---

最後更新: 2025-10-17
版本: 1.0.0
